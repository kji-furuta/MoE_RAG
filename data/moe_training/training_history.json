{
  "90146e67-a90c-4969-864e-b10a5b8742ae": {
    "task_id": "90146e67-a90c-4969-864e-b10a5b8742ae",
    "status": "completed",
    "progress": 100,
    "current_epoch": 1,
    "current_loss": 0.0,
    "config": {
      "training_type": "demo",
      "base_model": "outputs/フルファインチューニング_20250819_111844",
      "epochs": 3,
      "batch_size": 1,
      "learning_rate": 0.0001,
      "warmup_steps": 100,
      "save_steps": 500,
      "dataset": "demo",
      "experts": [
        "road",
        "regulations"
      ],
      "custom_data_path": null
    },
    "logs": [
      "[2025-08-19T10:01:20.221973] トレーニングを開始しました",
      "[2025-08-19T10:01:20.295555] OUT: ===========================================",
      "[2025-08-19T10:01:20.295573] OUT: MoE Training - AI_FT_7 Project",
      "[2025-08-19T10:01:20.295580] OUT: 土木・建設分野特化モデルトレーニング",
      "[2025-08-19T10:01:20.295588] OUT: ===========================================",
      "[2025-08-19T10:01:20.295627] OUT: Docker環境で実行中...",
      "[2025-08-19T10:01:20.295634] OUT: 実行モード: demo",
      "[2025-08-19T10:01:20.295639] OUT: エポック数: 3",
      "[2025-08-19T10:01:20.295642] OUT: バッチサイズ: 1",
      "[2025-08-19T10:01:20.295658] OUT: デモモードで実行します（小規模モデル）...",
      "[2025-08-19T10:01:20.295672] OUT: 使用モデル: /workspace/outputs/フルファインチューニング_20250819_111844",
      "[2025-08-19T10:01:27.069516] ERR: INFO:src.moe.moe_training:Loaded 720 samples from ./data/civil_engineering/train",
      "[2025-08-19T10:01:27.070156] ERR: INFO:src.moe.moe_training:Loaded 80 samples from ./data/civil_engineering/val",
      "[2025-08-19T10:01:29.817338] OUT: ============================================================",
      "[2025-08-19T10:01:29.817352] OUT: MoE土木・建設特化モデル トレーニング",
      "[2025-08-19T10:01:29.817357] OUT: ============================================================",
      "[2025-08-19T10:01:29.817361] OUT: ✓ GPU利用可能: 2 devices",
      "[2025-08-19T10:01:29.817365] OUT: Device 0: NVIDIA RTX A5000",
      "[2025-08-19T10:01:29.817367] OUT: Device 1: NVIDIA RTX A5000",
      "[2025-08-19T10:01:29.817373] OUT: 📝 デモモード: 小規模モデルで実行します",
      "[2025-08-19T10:01:29.817378] OUT: 設定:",
      "[2025-08-19T10:01:29.817381] OUT: エキスパート数: 8",
      "[2025-08-19T10:01:29.817384] OUT: アクティブエキスパート: 2",
      "[2025-08-19T10:01:29.817387] OUT: バッチサイズ: 1",
      "[2025-08-19T10:01:29.817389] OUT: 学習率: 2e-05",
      "[2025-08-19T10:01:29.817399] OUT: エポック数: 1",
      "[2025-08-19T10:01:29.817402] OUT: モデルを作成中...",
      "[2025-08-19T10:01:29.817405] OUT: ✓ モデル作成完了",
      "[2025-08-19T10:01:29.817408] OUT: パラメータ数: 367,673,440",
      "[2025-08-19T10:01:29.817411] OUT: トークナイザーを準備中...",
      "[2025-08-19T10:01:29.817415] OUT: データセットを準備中...",
      "[2025-08-19T10:01:29.817417] OUT: ✓ データセット準備完了",
      "[2025-08-19T10:01:29.817420] OUT: トレーニングサンプル: 720",
      "[2025-08-19T10:01:29.817423] OUT: 検証サンプル: 80",
      "[2025-08-19T10:01:29.817426] OUT: トレーナーを初期化中...",
      "[2025-08-19T10:01:29.817430] OUT: ============================================================",
      "[2025-08-19T10:01:29.817432] OUT: トレーニングを開始します...",
      "[2025-08-19T10:01:29.817434] OUT: ============================================================",
      "[2025-08-19T10:01:29.885850] ERR: Epoch 1/1:   0%|          | 0/720 [00:00<?, ?it/s]WARNING:src.moe.moe_architecture:Input IDs exceed vocab size: max=151646, vocab_size=32000. Clamping to safe range.",
      "[2025-08-19T10:01:30.501390] ERR: Epoch 1/1:   0%|          | 0/720 [00:00<?, ?it/s]",
      "[2025-08-19T10:01:30.502270] ERR: Traceback (most recent call last):",
      "[2025-08-19T10:01:30.502420] ERR: File \"/workspace/scripts/moe/run_training.py\", line 243, in main",
      "[2025-08-19T10:01:30.502427] ERR: trainer.train(train_dataset, val_dataset)",
      "[2025-08-19T10:01:30.502430] ERR: File \"/workspace/src/moe/moe_training.py\", line 300, in train",
      "[2025-08-19T10:01:30.502433] ERR: total_loss.backward()",
      "[2025-08-19T10:01:30.502439] ERR: File \"/opt/conda/lib/python3.11/site-packages/torch/_tensor.py\", line 581, in backward",
      "[2025-08-19T10:01:30.502442] ERR: torch.autograd.backward(",
      "[2025-08-19T10:01:30.502462] ERR: File \"/opt/conda/lib/python3.11/site-packages/torch/autograd/__init__.py\", line 347, in backward",
      "[2025-08-19T10:01:30.502465] ERR: _engine_run_backward(",
      "[2025-08-19T10:01:30.502469] ERR: File \"/opt/conda/lib/python3.11/site-packages/torch/autograd/graph.py\", line 825, in _engine_run_backward",
      "[2025-08-19T10:01:30.502471] ERR: return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass",
      "[2025-08-19T10:01:30.502474] ERR: ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^",
      "[2025-08-19T10:01:30.502481] ERR: RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn",
      "[2025-08-19T10:01:30.562237] OUT: ✗ エラーが発生しました: element 0 of tensors does not require grad and does not have a grad_fn",
      "[2025-08-19T10:01:30.562295] OUT: ============================================================",
      "[2025-08-19T10:01:30.562304] OUT: トレーニング終了",
      "[2025-08-19T10:01:30.562309] OUT: ============================================================",
      "[2025-08-19T10:01:30.562314] OUT: 結果の保存場所:",
      "[2025-08-19T10:01:30.562319] OUT: モデル: ./outputs/moe_demo",
      "[2025-08-19T10:01:30.562323] OUT: チェックポイント: ./checkpoints/moe_demo",
      "[2025-08-19T10:01:30.586727] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [0,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.586786] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [1,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.586801] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [2,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.586807] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [3,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.586811] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [4,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.586974] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [5,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587000] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [6,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587006] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [7,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587012] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [8,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587016] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [9,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587021] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [10,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587026] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [11,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587144] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [12,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587159] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [13,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587163] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [14,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587167] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [15,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587171] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [16,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587190] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [17,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587194] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [18,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587198] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [19,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587202] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [20,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587206] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [21,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587297] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [22,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587311] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [23,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587316] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [24,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587321] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [25,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587325] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [26,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587329] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [27,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587347] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [28,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587352] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [29,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587356] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [30,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:30.587359] ERR: ../aten/src/ATen/native/cuda/Loss.cu:250: nll_loss_forward_reduce_cuda_kernel_2d: block: [0,0,0], thread: [31,0,0] Assertion `t >= 0 && t < n_classes` failed.",
      "[2025-08-19T10:01:31.352217] OUT: ===========================================",
      "[2025-08-19T10:01:31.352238] OUT: トレーニング完了",
      "[2025-08-19T10:01:31.352243] OUT: ===========================================",
      "[2025-08-19T10:01:31.352641] トレーニングが正常に完了しました"
    ],
    "start_time": "2025-08-19T10:01:20.221970",
    "end_time": null,
    "error": null
  }
}