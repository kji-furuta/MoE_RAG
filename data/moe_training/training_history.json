{
  "90146e67-a90c-4969-864e-b10a5b8742ae": {
    "task_id": "90146e67-a90c-4969-864e-b10a5b8742ae",
    "status": "completed",
    "progress": 100,
    "current_epoch": 1,
    "current_loss": 0.0,
    "config": {
      "training_type": "demo",
      "base_model": "outputs/フルファインチューニング_20250819_111844",
      "epochs": 3,
      "batch_size": 1,
      "learning_rate": 0.0001,
      "warmup_steps": 100,
      "save_steps": 500,
      "dataset": "demo",
      "experts": [
        "road",
        "regulations"
      ],
      "custom_data_path": null
    },
    "logs": [
      "[2025-08-19T10:01:20.221973] トレーニングを開始しました",
      "[2025-08-19T10:01:20.295555] OUT: ===========================================",
      "[2025-08-19T10:01:20.295573] OUT: MoE Training - AI_FT_7 Project",
      "[2025-08-19T10:01:20.295580] OUT: 土木・建設分野特化モデルトレーニング",
      "[2025-08-19T10:01:20.295588] OUT: ===========================================",
      "[2025-08-19T10:01:20.295627] OUT: Docker環境で実行中...",
      "[2025-08-19T10:01:20.295634] OUT: 実行モード: demo",
      "[2025-08-19T10:01:20.295639] OUT: エポック数: 3",
      "[2025-08-19T10:01:20.295642] OUT: バッチサイズ: 1",
      "[2025-08-19T10:01:20.295658] OUT: デモモードで実行します（小規模モデル）...",
      "[2025-08-19T10:01:20.295672] OUT: 使用モデル: /workspace/outputs/フルファインチューニング_20250819_111844",
      "[2025-08-19T10:01:27.069516] ERR: INFO:src.moe.moe_training:Loaded 720 samples from ./data/civil_engineering/train",
      "[2025-08-19T10:01:27.070156] ERR: INFO:src.moe.moe_training:Loaded 80 samples from ./data/civil_engineering/val",
      "[2025-08-19T10:01:29.817338] OUT: ============================================================",
      "[2025-08-19T10:01:29.817352] OUT: MoE土木・建設特化モデル トレーニング",
      "[2025-08-19T10:01:29.817357] OUT: ============================================================",
      "[2025-08-19T10:01:29.817361] OUT: ✓ GPU利用可能: 2 devices",
      "[2025-08-19T10:01:29.817365] OUT: Device 0: NVIDIA RTX A5000",
      "[2025-08-19T10:01:29.817367] OUT: Device 1: NVIDIA RTX A5000",
      "[2025-08-19T10:01:29.817373] OUT: 📝 デモモード: 小規模モデルで実行します",
      "[2025-08-19T10:01:29.817378] OUT: 設定:",
      "[2025-08-19T10:01:29.817381] OUT: エキスパート数: 8",
      "[2025-08-19T10:01:29.817384] OUT: アクティブエキスパート: 2",
      "[2025-08-19T10:01:29.817387] OUT: バッチサイズ: 1",
      "[2025-08-19T10:01:29.817389] OUT: 学習率: 2e-05",
      "[2025-08-19T10:01:29.817399] OUT: エポック数: 1",
      "[2025-08-19T10:01:29.817402] OUT: モデルを作成中...",
      "[2025-08-19T10:01:29.817405] OUT: ✓ モデル作成完了",
      "[2025-08-19T10:01:29.817408] OUT: パラメータ数: 367,673,440",
      "[2025-08-19T10:01:29.817411] OUT: トークナイザーを準備中...",
      "[2025-08-19T10:01:29.817415] OUT: データセットを準備中...",
      "[2025-08-19T10:01:29.817417] OUT: ✓ データセット準備完了",
      "[2025-08-19T10:01:29.817420] OUT: トレーニングサンプル: 720",
      "[2025-08-19T10:01:29.817423] OUT: 検証サンプル: 80",
      "[2025-08-19T10:01:29.817426] OUT: トレーナーを初期化中...",
      "[2025-08-19T10:01:29.817430] OUT: ============================================================",
      "[2025-08-19T10:01:29.817432] OUT: トレーニングを開始します...",
      "[2025-08-19T10:01:29.817434] OUT: ============================================================",
      "[2025-08-19T10:01:29.885850] ERR: Epoch 1/1:   0%|          | 0/720 [00:00<?, ?it/s]WARNING:src.moe.moe_architecture:Input IDs exceed vocab size: max=151646, vocab_size=32000. Clamping to safe range.",
      "[2025-08-19T10:01:30.501390] ERR: Epoch 1/1:   0%|          | 0/720 [00:00<?, ?it/s]",
      "[2025-08-19T10:01:30.502270] ERR: Traceback (most recent call last):",
      "[2025-08-19T10:01:30.502420] ERR: File \"/workspace/scripts/moe/run_training.py\", line 243, in main",
      "[2025-08-19T10:01:30.502427] ERR: trainer.train(train_dataset, val_dataset)",
      "[2025-08-19T10:01:30.502430] ERR: File \"/workspace/src/moe/moe_training.py\", line 300, in train",
      "[2025-08-19T10:01:30.502433] ERR: total_loss.backward()",
      "[2025-08-19T10:01:30.502439] ERR: File \"/opt/conda/lib/python3.11/site-packages/torch/_tensor.py\", line 581, in backward",
      "[2025-08-19T10:01:30.502442] ERR: torch.autograd.backward(",
      "[2025-08-19T10:01:30.502462] ERR: File \"/opt/conda/lib/python3.11/site-packages/torch/autograd/__init__.py\", line 347, in backward",
      "[2025-08-19T10:01:30.502465] ERR: _engine_run_backward(",
      "[2025-08-19T10:01:30.502469] ERR: File \"/opt/conda/lib/python3.11/site-packages/torch/autograd/graph.py\", line 825, in _engine_run_backward"
    ],
    "start_time": "2025-08-19T10:01:20.221970",
    "end_time": null,
    "error": null
  },
  "d63ec0db-4f34-48d2-89c1-35b485a819f1": {
    "task_id": "d63ec0db-4f34-48d2-89c1-35b485a819f1",
    "status": "completed",
    "progress": 100,
    "current_epoch": 1,
    "current_loss": 0.0,
    "config": {
      "training_type": "full",
      "base_model": "/workspace/outputs/フルファインチューニング_20250824_184442",
      "epochs": 3,
      "batch_size": 1,
      "learning_rate": 0.0001,
      "warmup_steps": 100,
      "save_steps": 500,
      "dataset": "demo",
      "experts": [
        "road",
        "regulations"
      ],
      "custom_data_path": null
    },
    "logs": [
      "[2025-08-24T10:23:23.215196] トレーニングを開始しました",
      "[2025-08-24T10:23:23.435538] OUT: ===========================================",
      "[2025-08-24T10:23:23.435560] OUT: MoE Training - AI_FT_7 Project",
      "[2025-08-24T10:23:23.435570] OUT: 土木・建設分野特化モデルトレーニング",
      "[2025-08-24T10:23:23.435582] OUT: ===========================================",
      "[2025-08-24T10:23:23.435614] OUT: Docker環境で実行中...",
      "[2025-08-24T10:23:23.435627] OUT: 実行モード: full",
      "[2025-08-24T10:23:23.435633] OUT: エポック数: 3",
      "[2025-08-24T10:23:23.435636] OUT: バッチサイズ: 1",
      "[2025-08-24T10:23:23.435640] OUT: フルモードで実行します...",
      "[2025-08-24T10:23:23.435643] OUT: 使用モデル: /workspace/outputs/フルファインチューニング_20250824_184442",
      "[2025-08-24T10:23:32.146760] OUT: ============================================================",
      "[2025-08-24T10:23:32.146775] OUT: MoE土木・建設特化モデル トレーニング",
      "[2025-08-24T10:23:32.146780] OUT: ============================================================",
      "[2025-08-24T10:23:32.146783] OUT: ✓ GPU利用可能: 2 devices",
      "[2025-08-24T10:23:32.146787] OUT: Device 0: NVIDIA RTX A5000",
      "[2025-08-24T10:23:32.146789] OUT: Device 1: NVIDIA RTX A5000",
      "[2025-08-24T10:23:32.146793] OUT: 設定:",
      "[2025-08-24T10:23:32.146796] OUT: エキスパート数: 8",
      "[2025-08-24T10:23:32.146800] OUT: アクティブエキスパート: 2",
      "[2025-08-24T10:23:32.146803] OUT: バッチサイズ: 1",
      "[2025-08-24T10:23:32.146805] OUT: 学習率: 2e-05",
      "[2025-08-24T10:23:32.146808] OUT: エポック数: 3",
      "[2025-08-24T10:23:32.146811] OUT: モデルを作成中...",
      "[2025-08-24T10:23:32.146814] OUT: メモリ最適化モードでモデルを読み込み中...",
      "[2025-08-24T10:24:35.987275] ERR: Loading checkpoint shards:   0%|          | 0/14 [00:00<?, ?it/s]\rLoading checkpoint shards:   7%|▋         | 1/14 [00:04<00:57,  4.39s/it]\rLoading checkpoint shards:  14%|█▍        | 2/14 [00:08<00:52,  4.35s/it]\rLoading checkpoint shards:  21%|██▏       | 3/14 [00:14<00:55,  5.06s/it]\rLoading checkpoint shards:  29%|██▊       | 4/14 [00:19<00:48,  4.84s/it]\rLoading checkpoint shards:  36%|███▌      | 5/14 [00:23<00:42,  4.73s/it]\rLoading checkpoint shards:  43%|████▎     | 6/14 [00:28<00:37,  4.71s/it]\rLoading checkpoint shards:  50%|█████     | 7/14 [00:32<00:32,  4.66s/it]\rLoading checkpoint shards:  57%|█████▋    | 8/14 [00:37<00:27,  4.64s/it]\rLoading checkpoint shards:  64%|██████▍   | 9/14 [00:42<00:24,  4.85s/it]\rLoading checkpoint shards:  71%|███████▏  | 10/14 [00:48<00:20,  5.01s/it]\rLoading checkpoint shards:  79%|███████▊  | 11/14 [00:52<00:14,  4.88s/it]\rLoading checkpoint shards:  86%|████████▌ | 12/14 [00:57<00:09,  4.80s/it]\rLoading checkpoint shards:  93%|█████████▎| 13/14 [01:01<00:04,  4.72s/it]\rLoading checkpoint shards: 100%|██████████| 14/14 [01:03<00:00,  3.88s/it]\rLoading checkpoint shards: 100%|██████████| 14/14 [01:03<00:00,  4.56s/it]",
      "[2025-08-24T10:24:38.259475] ERR: INFO:src.moe.moe_architecture:Using quantized model with LoRA directly (no MoE wrapper)",
      "[2025-08-24T10:24:38.537337] ERR: INFO:src.moe.moe_training:Loaded 720 samples from ./data/civil_engineering/train",
      "[2025-08-24T10:24:38.539346] ERR: INFO:src.moe.moe_training:Loaded 80 samples from ./data/civil_engineering/val",
      "[2025-08-24T10:24:38.539480] ERR: INFO:src.moe.moe_training:Skipping model device placement (already mapped or quantized)",
      "[2025-08-24T10:24:38.547541] ERR: /workspace/src/moe/moe_training.py:190: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.",
      "[2025-08-24T10:24:38.547549] ERR: self.scaler = torch.cuda.amp.GradScaler() if config.mixed_precision else None",
      "[2025-08-24T10:24:38.558417] OUT: trainable params: 100,663,296 || all params: 32,864,539,648 || trainable%: 0.3063",
      "[2025-08-24T10:24:38.558427] OUT: ✓ モデル作成完了",
      "[2025-08-24T10:24:38.558432] OUT: パラメータ数: 17,261,728,768",
      "[2025-08-24T10:24:38.558438] OUT: トークナイザーを準備中...",
      "[2025-08-24T10:24:38.558442] OUT: データセットを準備中...",
      "[2025-08-24T10:24:38.558444] OUT: ✓ データセット準備完了",
      "[2025-08-24T10:24:38.558447] OUT: トレーニングサンプル: 720",
      "[2025-08-24T10:24:38.558450] OUT: 検証サンプル: 80",
      "[2025-08-24T10:24:38.558453] OUT: トレーナーを初期化中...",
      "[2025-08-24T10:24:38.558457] OUT: ============================================================",
      "[2025-08-24T10:24:38.558460] OUT: トレーニングを開始します...",
      "[2025-08-24T10:24:38.558462] OUT: ============================================================",
      "[2025-08-24T10:24:38.602399] ERR: Epoch 1/3:   0%|          | 0/720 [00:00<?, ?it/s]/workspace/src/moe/moe_training.py:269: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.",
      "[2025-08-24T10:24:38.602435] ERR: with torch.cuda.amp.autocast() if self.config.mixed_precision and self.device.type == \"cuda\" else torch.no_grad():",
      "[2025-08-24T10:24:38.602882] ERR: `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.",
      "[2025-08-24T10:24:38.761145] ERR: /opt/conda/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.",
      "[2025-08-24T10:24:38.761161] ERR: return fn(*args, **kwargs)",
      "[2025-08-24T10:24:40.183648] ERR: Epoch 1/3:   0%|          | 0/720 [00:01<?, ?it/s]",
      "[2025-08-24T10:24:40.184840] ERR: Traceback (most recent call last):",
      "[2025-08-24T10:24:40.185000] ERR: File \"/workspace/scripts/moe/run_training.py\", line 243, in main",
      "[2025-08-24T10:24:40.185006] ERR: trainer.train(train_dataset, val_dataset)",
      "[2025-08-24T10:24:40.185011] ERR: File \"/workspace/src/moe/moe_training.py\", line 277, in train",
      "[2025-08-24T10:24:40.185014] ERR: hidden_states = outputs['hidden_states']",
      "[2025-08-24T10:24:40.185017] ERR: ~~~~~~~^^^^^^^^^^^^^^^^^",
      "[2025-08-24T10:24:40.185020] ERR: File \"/opt/conda/lib/python3.11/site-packages/transformers/utils/generic.py\", line 454, in __getitem__",
      "[2025-08-24T10:24:40.185023] ERR: return inner_dict[k]",
      "[2025-08-24T10:24:40.185025] ERR: ~~~~~~~~~~^^^",
      "[2025-08-24T10:24:40.185033] ERR: KeyError: 'hidden_states'",
      "[2025-08-24T10:24:40.211368] OUT: ✗ エラーが発生しました: 'hidden_states'",
      "[2025-08-24T10:24:40.211390] OUT: ============================================================",
      "[2025-08-24T10:24:40.211394] OUT: トレーニング終了",
      "[2025-08-24T10:24:40.211398] OUT: ============================================================",
      "[2025-08-24T10:24:40.211402] OUT: 結果の保存場所:",
      "[2025-08-24T10:24:40.211407] OUT: モデル: ./outputs/moe_civil",
      "[2025-08-24T10:24:40.211411] OUT: チェックポイント: ./checkpoints/moe_civil",
      "[2025-08-24T10:24:41.793492] OUT: ===========================================",
      "[2025-08-24T10:24:41.793511] OUT: トレーニング完了",
      "[2025-08-24T10:24:41.793516] OUT: ===========================================",
      "[2025-08-24T10:24:41.794998] トレーニングが正常に完了しました"
    ],
    "start_time": "2025-08-24T10:23:23.215193",
    "end_time": null,
    "error": null
  }
}